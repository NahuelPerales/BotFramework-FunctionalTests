name: $(Build.BuildId)
trigger: none
pr: none

pool:
  vmImage: 'windows-2019'

variables:
  BuildConfiguration: 'Debug'
  BuildPlatform: 'AnyCPU'
  # Name: (optional) Define in Azure
  # LastName: (optional) Define in Azure
  IntLastName: $[coalesce(variables['LastName'], '')]

stages:
- stage: LastName
  jobs:
    - job: CheckLastName
      steps:
        - powershell: |
            $LastName = '$(IntLastName)'
            Write-Host "LastName: '$LastName'"
            Write-Host "##vso[task.setvariable variable=apellido;isOutput=true]$($LastName)"
          name: checkValue
          failOnStderr: true
    - job: UseLastName
      dependsOn: CheckLastName
      variables:
        Apellido: $[ dependencies.CheckLastName.outputs['checkValue.apellido'] ]
      condition: and(succeeded(), ne('', '$Apellido'))
      steps:
        - powershell: |
              Write-Host "LastName: $(Apellido)"
          failOnStderr: true
