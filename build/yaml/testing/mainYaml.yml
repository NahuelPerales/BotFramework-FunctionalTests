name: $(Build.BuildId)
trigger: none
pr: none

pool:
  vmImage: 'windows-2019'

variables:
  BuildConfiguration: 'Debug'
  BuildPlatform: 'AnyCPU'
  # Name: (optional) Define in Azure
  # LastName: (optional) Define in Azure

  # IntLastName: $[coalesce(variables['LastName'], '')]

stages:
- stage: FirstStage
  jobs:
    - job: DisplayName
      steps:
        - powershell: |
            Write-Host "Name: $(NAME)";
          failOnStderr: true

- stage: SecondStage
  dependsOn: FirstStage
  jobs:
    - job: CheckLastName
      steps:
        - powershell: |
            if ([System.String]::IsNullOrEmpty('$[variables.LastName]') {
              Write-Host "Empty LastName"
            }
            else {
              Write-Host "LastName: '$[variables.LastName]'"
              Write-Host "##vso[task.setvariable variable=apellido]$($[variables.LastName])"
            }
          failOnStderr: true
        - powershell: |
            Write-Host "LastName: '$(apellido)'";
          condition: ne('$(apellido)', '')
          failOnStderr: true
